# Read my php-fpm log.
input {
	file {
		path => "/var/log/php-fpm.log"
		tags => [ "php-fpm" ]
		start_position => "beginning"
		sincedb_path => "/dev/null"
	}
}

filter {
	if "php-fpm" in [tags] {
		grok {
			match => { "message" => "%{PHPFPMLOG}" }
			patterns_dir => [ "/etc/logstash/patterns.d" ]
			remove_field => [ "message" ]
		}
		date {
			match => [ "timestamp", "dd-MMM-YYYY HH:mm:ss" ]
			remove_field => [ "timestamp" ]
		}
		mutate {
			rename => { "msg" => "message" }
		}
	}
}

